@echo off
setlocal enabledelayedexpansion

rem ① 引数を取得
set name=%1
set message=%2

rem ② スケジュールJSONの場所を指定
set jsonPath="\\Aefs01\AWHI札幌ハイブリッド推進グループ\HBSPortal\公開用\schedule.json"

rem ③ 一時ファイルに新しいエントリを追加
for /f "delims=" %%i in ('type %jsonPath%') do set content=%%i
if "!content!"=="[]" (
    echo [{"name":"%name%","message":"%message%"}]> %jsonPath%
) else (
    set content=!content:]=,{"name":"%name%","message":"%message%"}]!
    echo !content!> %jsonPath%
)

echo 追加しました。
timeout /t 2 >nul
